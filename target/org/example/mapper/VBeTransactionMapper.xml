<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.mapper.VBeTransactionMapper">
    <select id="selectAll" resultType="org.example.model.VBeTransaction">
        SELECT id, Time, region, locationName, machineName, machineNumber, Devid, slot,
        productName, barCode, ProductTypeName, Amount, PayType, PayTransactionId,
        PayUserID, PayOutTradeNo, isProcessed, ProcessedDateTime, ProcessedId
        FROM dbo.V_BE_Transaction
        WHERE (isProcessed = 0 OR isProcessed IS NULL) --AND cast([Time] as date) = cast(getdate() as date)
        ORDER BY Time
    </select>
    <update id="markAsProcessed">
        UPDATE dbo.TSalesSource
        SET isProcessed = 1,
        ProcessedDateTime = GETDATE(),
        ProcessedId = #{processedId}
        WHERE id = #{id}
    </update>
</mapper>